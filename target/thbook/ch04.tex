\eject

\chapter Что мы получаем?. 

\subchapter Информационный файл. 

\subsubchapter Файл журнала. 

Помимо сообщений от Therion'а и других используемых программ, файл журнала содержит информацию о вычисленных значениях магнитного скло\-нения и конвергенции меридиана, ошибок колец и искажений скрапов. 

Абсолютная ошибка кольца равна $\sqrt{d_x^2+d_y^2+d_z^2}$, где $d_x$ разность между одина\-ковыми начальными и конечными точками кольца до распределения ошибок, измеренная вдоль оси координат $x$; аналогично для $y$ и $z$. Процентная погрешность кольца вычисляется как {\it абсолютная ошибка / длину кольца}. Средняя ошибка -- это простое арифметическое среднее всех ошибок кольца. 

Искажение скрапа вычисляется с использованием меры искажения, опреде\-ленной для всех пар точек (точечные символы, точки и контрольные точки линейных символов) в скрапе. Мера рассчитывается как $\left\vert d_a-d_b\right\vert\over d_b$, где $d_b$ -- это расстояние до деформирования, а $d_a$ -- расстояние до точек после деформиро\-вания. Максимальные и средние искажения скрапа вычисляются как макси\-мальные или средние значения таких мер, применяемых ко всем парам точек. 

\subsubchapter XTherion. 

Если опция |-x| включена, то Therion выводит некоторые основные данные о каждой съемки (длина, амплитуда, длина с севера на юг, длина с запада на восток, количество замеров и станций). Эта информация отображается в окне XTherion'а {\it Компилятор}, в меню {\it Информация}, когда выбрана какая-либо съемка в меню {\it Структура съемки}. 

\subsubchapter Экспорт SQL. 

Экспорт SQL позволяет легко получить очень подробную информацию о нитке хода. Это текстовый файл, начинающийся с объявления таблиц (where `?' stands in the following listing for a maximal value required by the column data): 

|create table SURVEY (ID integer, PARENT_ID integer,
	NAME varchar(?), FULL_NAME varchar(?), TITLE varchar(?));
create table CENTRELINE (ID integer, SURVEY_ID integer,
	TITLE varchar(?), TOPO_DATE date, EXPLO_DATE date,
	LENGTH real, SURFACE_LENGTH real, DUPLICATE_LENGTH real);
create table PERSON (ID integer, NAME varchar(?), SURNAME varchar(?));
create table EXPLO (PERSON_ID integer, CENTRELINE_ID integer);
create table TOPO (PERSON_ID integer, CENTRELINE_ID integer);
create table STATION (ID integer, NAME varchar(?),
	SURVEY_ID integer, X real, Y real, Z real);
create table STATION_FLAG (STATION_ID integer, FLAG char(3));
create table SHOT (ID integer, FROM_ID integer, TO_ID integer,
	CENTRELINE_ID integer, LENGTH real, BEARING real, GRADIENT real,
	ADJ_LENGTH real, ADJ_BEARING real, ADJ_GRADIENT real,
	ERR_LENGTH real, ERR_BEARING real, ERR_GRADIENT real);
create table SHOT_FLAG (SHOT_ID integer, FLAG char(3));| 

which is followed by a mass of SQL insert commands. This file may be loaded into any SQL database (after some database-dependent initialization, which may include running a SQL server and connecting to it, creating a database and connecting to it. A good idea is to start a transaction before loading this file, if database doesn't start a transaction automatically.) It's important to set-up database encoding to match the one specified in Therion |export database| command. 

\midinsert

\centerline{\pic{database.pdf}} \endinsert

%
Table and column names are self-explaining; for undefined or non-existing values |NULL| is used. |FLAG| in |SHOT_FLAG| table is |dpl| or |srf| for duplicated or surface shots; in |STATION_FLAG| table |ent|, |con|, |fix|, |spr|, |sin|, |dol|, |dig|, |air|, |ove|, |arc| for stations with entrance, continuation, fixed, spring, sink, doline, dig, air-draught, overhang or arch attributes, respectively. 

Examples of simple queries follow: 

\penalty-100{\it List of survey team members with an information how much has each of them surveyed:} 

|select sum(LENGTH), sum(SURFACE_LENGTH), NAME, SURNAME from CENTRELINE, TOPO, PERSON where CENTRELINE.ID = TOPO.CENTRELINE_ID and PERSON.ID = PERSON_ID group by NAME, SURNAME order by 1 desc, 4 asc;| 

{\it Which parts of the cave were surveyed in the year 1998?} 

|select TITLE from SURVEY where ID in (select SURVEY_ID from CENTRELINE where TOPO_DATE between '1998-01-01' and '1998-12-31');| 

{\it How long are passages lying between 1500 and 1550 m a.s.l.?} 

|select sum(LENGTH) from SHOT, STATION S1, STATION S2 where (S1.Z+S2.Z)/2 between 1500 and 1550 and SHOT.FROM_ID = S1.ID and SHOT.TO_ID = S2.ID;| 

\subsubchapter Lists---caves, surveys, continuations. 

Using |export continuation-list| you get an overview of all points in the centreline and scraps marked \[using |station| attribute for centreline point and |point continuation| in scraps] as a possible continuation. 

|export cave-list| gives you a tabular information about surveyed caves (you need to specify |entrance| flags in your data) including length, depth and entrance(s) location. 

Detailed information about each sub-survey gives |export survey-list| command. The length includes shots with |approximate| flags, but not |explored|, |duplicate| or |surface|. 

\subchapter 2D maps. 

\subsubchapter Maps for printing. 

Maps are produced in PDF and SVG formats, which may be viewed or printed in a wide variety of viewers. Be sure to uncheck {\it Fit page to paper} or similar option if you want to print in the exact scale. 

In atlas mode some additional information is put on each page: page number, map name, and page label. 

Especially useful are the numbers of neighbouring pages in N, S, E and W directions, as well as in upper and lower levels. There are also hyperlinks at the border of the map if the cave continues on the next page and on the appropriate cells of the Navigator. 

PDF files are highly optimized---scraps are stored in XObject forms only once in the document and than referenced on appropriate pages. Therion uses most advanced PDF features like transparency and layers. 

Created PDF files may be optionally post-processed in applications like pdf\TeX\ or Adobe Acrobat---it's possible to extract or change some pages, add comments or encryption, etc. 

\NEW{5.3}If the map was produced using georeferenced data then it also contains georeferencing information. This can be extracted by XTherion to produce georeferenced raster images (see {\it XTherion/Additional tools} for details). 

\subsubchapter Maps for GIS. 

Maps produced in DXF, ESRI or KML formats may be further processed in appropriate software. These maps do not contain visualized map symbols 

\subsubchapter Special-purpose maps. 

Map in XVI format contains centreline with LRUD (and optionally morphed sketches) and can be imported in XTherion to serve as a background for digitization. 

Map in Survex format is intended for a quick preview in Aven. 

\subchapter 3D models. 

Therion may export 3D model in various formats besides its native format. These may be loaded in appropriate viewing, editing or raytracing programs to be printed or further processed. If the format doesn't support arbitrary passage shape definition, only the centreline is included. 

\subsubchapter Loch. 

Loch is a 3D model viewer included in the Therion distribution. It supports e.g.~high-resolution rendering to file and stereo view using 3D-glasses. 

\endinput

